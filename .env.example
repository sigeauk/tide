# ============================================
# TIDE Environment Configuration
# ============================================
# Copy this file to .env and fill in your values
# NEVER commit .env to version control
# ============================================

# --- APPLICATION SETTINGS ---
TIDE_VERSION=2.1.4
APP_URL=https://tide:8501
SYNC_INTERVAL_MINUTES=60

# --- AUTHENTICATION ---
# Set to 'true' to disable Keycloak and run in standalone mode
AUTH_DISABLED=true

# Keycloak OIDC (required if AUTH_DISABLED=false)
KEYCLOAK_URL=http://keycloak:8080
KEYCLOAK_INTERNAL_URL=http://keycloak:8080
KEYCLOAK_REALM=tide
KEYCLOAK_CLIENT_ID=tide-app
KEYCLOAK_CLIENT_SECRET=<your-client-secret>

# --- ELASTIC SECURITY (Required) ---
# Kibana URL for rule management
ELASTIC_URL=https://kibana.yourdomain.local:5601
# Elasticsearch URL for direct queries
ELASTICSEARCH_URL=https://elasticsearch.yourdomain.local:9200
# API Key with detection rules read/write permissions
ELASTIC_API_KEY=<your-elastic-api-key>
# Comma-separated Kibana spaces to sync
KIBANA_SPACES=production,staging

# --- OPENCTI (Optional) ---
# Threat intelligence platform integration
OPENCTI_URL=https://opencti.yourdomain.local:8080
OPENCTI_TOKEN=<your-opencti-token>

# --- GITLAB (Optional) ---
# For report dispatching to internal GitLab
GITLAB_URL=https://gitlab.yourdomain.local/
GITLAB_TOKEN=<your-gitlab-token>

# --- MITRE ATT&CK DATA SOURCES ---
# For air-gapped: host these files on internal server
MITRE_SOURCE=https://raw.githubusercontent.com/mitre/cti/master/enterprise-attack/enterprise-attack.json
MITRE_MOBILE_SOURCE=https://raw.githubusercontent.com/mitre/cti/master/mobile-attack/mobile-attack.json
MITRE_ICS_SOURCE=https://raw.githubusercontent.com/mitre/cti/master/ics-attack/ics-attack.json
MITRE_PRE_SOURCE=https://raw.githubusercontent.com/mitre/cti/master/pre-attack/pre-attack.json

# --- SIGMA RULES ---
# GitHub URL for Sigma rule repository
SIGMA_REPO_URL=https://github.com/SigmaHQ/sigma.git

# Elastic detection rules repository
ELASTIC_REPO_URL=https://github.com/elastic/detection-rules.git

# --- SSL/TLS (Production) ---
# Certificate paths for Nginx (mount via volume to /etc/nginx/certs/)
SSL_CERT_PATH=/etc/nginx/certs/fullchain.pem
SSL_KEY_PATH=/etc/nginx/certs/privkey.pem

# CA Bundle for outbound HTTPS requests (Python/requests)
SSL_CERT_FOLDER=/etc/ssl/certs/ca-certificates.crt
REQUESTS_CA_BUNDLE=/etc/ssl/certs/ca-certificates.crt

# Generate self-signed certs for development:
# openssl req -x509 -nodes -days 365 -newkey rsa:2048 \
#   -keyout certs/privkey.pem -out certs/fullchain.pem \
#   -subj "/CN=tide.local"

# --- DATABASE ---
# DuckDB path (relative to /app in container)
DUCKDB_PATH=data/tide.duckdb

# --- LOGGING ---
LOG_LEVEL=INFO
RULE_LOG_PATH=C:\ProgramData\tide\log\rules
# LOG_FORMAT=json
